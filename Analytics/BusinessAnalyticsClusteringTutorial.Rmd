---
title: "Business Analytics Clustering Tutorial"
author: "by Kim Fitter"
output: 
  html_document: 
    toc: true
    toc_float: true 
---

**DRAFT**

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction

This tutorial is aimed at those who would also like to use R for data analysis and business analytics.

This introductory level tutorial assumes you have already installed R and R studio and had a brief introduction to the R basics and R Markdown. 

From this R Markdown run each line of code (Ctrl + Enter) or code chunk (Ctrl + Shift +Enter) yourself or Knit -> Knit to HTML to read through the HTML version.

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r packages}
library(tidyverse)
library(cluster)
```

# Clustering


Let's use the UCI [Online Retail Data Set](https://archive.ics.uci.edu/ml/datasets/Online+Retail) dataset.

>This is a transnational data set which contains all the transactions occurring between 01/12/2010 and 09/12/2011 for a UK-based and registered non-store online retail.



The `retail.xlsx` file is available at the same link:

https://github.com/kimnewzealand/R-tutorials/tree/master/Analytics


We can import this data using the `read_excel()` function from the `readxl` package and assign `<-` the data to an object called `retail`.

Type ?read_excel in your console and read the Help documentation.

 

```{r import retail data}
# Assign the url of the path to the RAW retail.xlsx
url <- "https://archive.ics.uci.edu/ml/machine-learning-databases/00352/Online%20Retail.xlsx"
# Use the read_excel function and the httr package to write_disk
GET(url, write_disk("retail.xlsx"))
retail <- read_excel("retail.xlsx",n_max=100)
```


```{r kmeans}
# Scale numeric variables
retail_scaled <- retail %>% 
      select(Quantity,UnitPrice) %>% 
      scale() 
class(retail_scaled)
set.seed(123)
fit_kmeans <- kmeans(retail_scaled,centers = 10,nstart=20)

clusplot(retail_scaled, fit_kmeans$cluster, color=TRUE, shade=TRUE) 
```

```{r model based clustering}
# Model Based Clustering
library(mclust)
fit_mclust <- Mclust(retail_scaled)
plot(fit_mclust) # plot results 
summary(fit_mclust) # display the best model
```
